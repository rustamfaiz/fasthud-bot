import asyncio
import logging
import os
from aiogram import Bot, Dispatcher, types, F
from aiogram.enums import ParseMode
from aiogram.types import (
    InlineKeyboardMarkup,
    InlineKeyboardButton,
    ReplyKeyboardMarkup,
    KeyboardButton,
    Message,
    CallbackQuery,
)
from aiogram.filters import CommandStart
from dotenv import load_dotenv

# –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
load_dotenv()
TOKEN = os.getenv("BOT_TOKEN")

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(level=logging.INFO)

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞ –∏ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
bot = Bot(token=TOKEN, parse_mode=ParseMode.HTML)
dp = Dispatcher()

# –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
text_welcome = (
    "üéØ <b>–ü–æ–∑–¥—Ä–∞–≤–ª—è—é.</b>\n"
    "–ù–æ–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞. –ù–æ–≤—ã–π –∑–∞—Ö–æ–¥. –û—á–µ—Ä–µ–¥–Ω–æ–π —Å—Ç–∞—Ä—Ç –ø—Ä–æ—Ç–∏–≤ –∂–∏—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –≤—Å—ë –µ—â—ë —Å —Ç–æ–±–æ–π.\n\n"
    "‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî\n\n"
    "–î–∞–≤–∞–π —á–µ—Å—Ç–Ω–æ ‚Äî —É —Ç–µ–±—è —É–∂–µ –±—ã–ª–∏ –¥–∏–µ—Ç—ã, –±—ã–ª –±–µ–≥, –±—ã–ª–∞ –Ω–∞–¥–µ–∂–¥–∞ —É–≤–∏–¥–µ—Ç—å –ø–ª–æ—Å–∫–∏–π –∂–∏–≤–æ—Ç ‚Äî —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ä–∞–∑, –±–µ–∑ –≤–æ–∑–≤—Ä–∞—Ç–∞.\n"
    "–ù–æ –≤–º–µ—Å—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ ‚Äî —Å–Ω–æ–≤–∞ —Ü–∏—Ñ—Ä—ã —Ç—É–¥–∞-—Å—é–¥–∞. –ò —Å–Ω–æ–≤–∞ –Ω–∏—á–µ–≥–æ.\n\n"
    "‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî\n\n"
    "üëã <b>–ü—Ä–∏–≤–µ—Ç. –ú–µ–Ω—è –∑–æ–≤—É—Ç –†—É—Å—Ç–∞–º.</b>\n"
    "–í 2019 –≥–æ–¥—É —è —Å–∂—ë–≥ –¥–≤–∞–¥—Ü–∞—Ç—å –∫–∏–ª–æ–≥—Ä–∞–º–º–æ–≤ ‚Äî —á–µ—Ä–µ–∑ –≥–æ–ª–æ–¥, –±–µ–≥, –ø–æ–ª–Ω–æ–µ –æ—Ç—Ä–µ—á–µ–Ω–∏–µ –æ—Ç —Å–ª–∞–¥–∫–æ–≥–æ, –º—É—á–Ω–æ–≥–æ –∏ –∂–∏–∑–Ω–∏.\n\n"
    "–ù–∞—Å—Ç–æ–ª—å–∫–æ —É—à—ë–ª –≤ –ø—Ä–æ—Ü–µ—Å—Å, —á—Ç–æ —Ä–∞–∑–æ–±—Ä–∞–ª —Ñ–∏–∑–∏–æ–ª–æ–≥–∏—é, –Ω—É—Ç—Ä–∏—Ü–∏–æ–ª–æ–≥–∏—é –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—É—é –º–µ—Ö–∞–Ω–∏–∫—É –¥–æ –∫–æ—Å—Ç–µ–π.\n"
    "–ü–æ—Ç–æ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –Ω–∞–±–∏—Ä–∞–ª –∂–∏—Ä ‚Äî –∏ —Å–∂–∏–≥–∞–ª –µ–≥–æ —Å–Ω–æ–≤–∞. –ù–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑.\n"
    "–°–∏—Å—Ç–µ–º–Ω–æ. –ë–µ–∑ –≥–æ–ª–æ–¥–∞, –±–µ–∑ –±–µ–≥–∞ –∏ —Å–æ –≤–∫—É—Å–æ–º –∂–∏–∑–Ω–∏. –ó–∞ 4 –º–µ—Å—è—Ü–∞.\n\n"
    "–¢–∞–∫ –∏ –ø–æ—è–≤–∏–ª–∞—Å—å —ç—Ç–∞ –∫–Ω–∏–≥–∞.\n"
    "–ù–µ –∏–∑ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è. –ê –∏–∑ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤ –±–æ—Ä—å–±–µ —Å —Ñ–∏—Ç–Ω–µ—Å-–º–∏—Ñ–∞–º–∏ –∏ –±–µ—Å–ø–æ–ª–µ–∑–Ω—ã–º–∏ —Ä–∏—Ç—É–∞–ª–∞–º–∏.\n\n"
    "üö´ –≠—Ç–æ –Ω–µ –ø—Ä–æ –º–æ—Ç–∏–≤–∞—Ü–∏—é. –≠—Ç–æ –ø—Ä–æ –º–µ—Ç–æ–¥.\n"
    "üî• –ö–∞–∫ –∑–∞ 4 –º–µ—Å—è—Ü–∞ —É–±—Ä–∞—Ç—å –∂–∏—Ä ‚Äî –∏ –Ω–µ –≤–µ—Ä–Ω—É—Ç—å –µ–≥–æ –±–æ–ª—å—à–µ –Ω–∏–∫–æ–≥–¥–∞.\n\n"
    "‚¨áÔ∏è –ñ–º–∏ –∫–Ω–æ–ø–∫—É ‚Äî –∏ –ø–æ–ª—É—á–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é."
)

# –ö–Ω–æ–ø–∫–∏ –ø–æ–¥ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ–º
welcome_keyboard = InlineKeyboardMarkup(inline_keyboard=[
    [InlineKeyboardButton(text="üí∏ –ü–æ–ª—É—á–∏—Ç—å –∫–Ω–∏–≥—É", callback_data="get_book")],
    [InlineKeyboardButton(text="üéØ –ß—Ç–æ —Ç—ã –ø–æ–ª—É—á–∏—à—å –∏–∑ —ç—Ç–æ–π –∫–Ω–∏–≥–∏", callback_data="book_info")]
])

# –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ —Å—Ç—Ä–∞–Ω—ã
country_keyboard = ReplyKeyboardMarkup(
    keyboard=[
        [KeyboardButton(text="–†–æ—Å—Å–∏—è")],
        [KeyboardButton(text="–°–®–ê / –î—Ä—É–≥–∞—è —Å—Ç—Ä–∞–Ω–∞")]
    ],
    resize_keyboard=True,
    one_time_keyboard=True
)

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã /start
@dp.message(CommandStart())
async def cmd_start(message: Message):
    await message.answer(text_welcome, reply_markup=welcome_keyboard)

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ "–ü–æ–ª—É—á–∏—Ç—å –∫–Ω–∏–≥—É"
@dp.callback_query(F.data == "get_book")
async def handle_get_book(callback: CallbackQuery):
    await callback.answer()
    await callback.message.answer("üìï –°–µ–π—á–∞—Å –Ω–∞—á–Ω—ë–º. –í—ã–±–µ—Ä–∏ —Å—Ç—Ä–∞–Ω—É –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è:", reply_markup=country_keyboard)

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —Å—Ç—Ä–∞–Ω—ã
@dp.message(F.text.in_(["–†–æ—Å—Å–∏—è", "–°–®–ê / –î—Ä—É–≥–∞—è —Å—Ç—Ä–∞–Ω–∞"]))
async def handle_country(message: Message):
    if message.text == "–†–æ—Å—Å–∏—è":
        await message.answer("üí≥ –¶–µ–Ω–∞ –¥–ª—è –†–æ—Å—Å–∏–∏: 990‚ÇΩ. (–ó–¥–µ—Å—å –±—É–¥–µ—Ç –∫–Ω–æ–ø–∫–∞ –æ–ø–ª–∞—Ç—ã)", reply_markup=types.ReplyKeyboardRemove())
    else:
        await message.answer("üí≥ –¶–µ–Ω–∞ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Å—Ç—Ä–∞–Ω: $19. (–ó–¥–µ—Å—å –±—É–¥–µ—Ç –∫–Ω–æ–ø–∫–∞ –æ–ø–ª–∞—Ç—ã)", reply_markup=types.ReplyKeyboardRemove())

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ "–ß—Ç–æ —Ç—ã –ø–æ–ª—É—á–∏—à—å –∏–∑ –∫–Ω–∏–≥–∏"
@dp.callback_query(F.data == "book_info")
async def handle_book_info(callback: CallbackQuery):
    await callback.answer()
    await callback.message.answer(
        "üìö <b>–ß—Ç–æ –≤–Ω—É—Ç—Ä–∏ –∫–Ω–∏–≥–∏:</b>\n"
        "‚Äî –ö–∞–∫ —Å–∂–∏–≥–∞—Ç—å –∂–∏—Ä –±–µ–∑ –≥–æ–ª–æ–¥–∞\n"
        "‚Äî –ü–æ—á–µ–º—É –±–µ–≥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç\n"
        "‚Äî –°–∏—Å—Ç–µ–º–∞ –ø–∏—Ç–∞–Ω–∏—è, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—è\n"
        "‚Äî –ú–∏—Ñ—ã, –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ –∏ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å\n\n"
        "–ü–æ–ª–Ω—ã–π –ø–ª–∞–Ω –Ω–∞ 4 –º–µ—Å—è—Ü–∞. –ë–µ–∑ –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –º—É—Å–æ—Ä–∞. –¢–æ–ª—å–∫–æ —Ä–∞–±–æ—Ç–∞—é—â–∞—è —Å—Ö–µ–º–∞."
    )

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
async def main():
    await dp.start_polling(bot)

if __name__ == "__main__":
    asyncio.run(main())
